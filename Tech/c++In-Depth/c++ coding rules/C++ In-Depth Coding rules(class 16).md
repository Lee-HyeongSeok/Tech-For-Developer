## C++ In-Depth Coding rules(class 16)

***

<br>

### :pushpin: const를 사용하라

- 변하지 않는 값은 추적하고, 이해하기 쉽다.

  > 상수가 많으면 상수가 정의된 부분과 값만을 신경 쓰면 되기 때문에 코드가 간결해 진다.
  >
  > ```c++
  > void fun(vector<int>& v){
  >     const size_t len = v.size();
  > }
  > ```
  >
  > :point_right: len의 정의 부분을 보면 그 의미와 값을 쉽게 파악할 수 있다(const에서 다른 것으로 변환하지 않는다는 가정 하에)
  >
  > :point_right: const가 없었다면 이 변수의 값은 이후에 변경될 수 있는 것이므로 불확실했을 것이다.

- 값을 정의할 때 그 이유가 적당하다면 **const를 사용하여 상수를 만드는 것**이 좋다.

- 상수는 안전하고, 컴파일 시에 검사되며, C++ 타입 시스템과 부합된다.

<br>

### :pushpin: 물론 const가 항상 불변의 의미를 가지는 것은 아니다.

- 타입 X 멤버를 가지는 클래스 C가 있다고 가정
  - C 객체가 const라면 X* 멤버도 const이겠지만, X 객체에 의해 포인팅되는 대상은 const가 아니다.

<br>

### :pushpin: const 사용이 적절한지를 따질 때에는 mutable 멤버를 사용하자

- 클래스의 const 멤버 함수가 멤버 변수를 변경할 필요가 있을 때 멤버 변수를 mutable로 선언

  > 변수가 객체의 주요 상태에 영향을 주지 않는 경우, 예를 들어 캐시된 데이터 등
  >
  > ```c++
  > class A{
  > private:
  >     mutable int value;
  > public:
  >     void func() const{
  >         value=0;
  >     }
  > }
  > ```
  >
  > :point_right: func() 함수는 상수 멤버 함수로 선언되었지만 멤버 변수 value의 값을 변경할 수 있다.
  >
  > :point_right: value가 상수 멤버 함수에서도 값을 변경할 수 있는 mutable로 선언되었기 때문이다.

- 하지만 모든 private 멤버들이 숨겨져 있는 상황이라면 캐시된 정보나 변하지 않는 포인터 양쪽 모두에 mutable을 사용할 필요가 없다.

<br>

### :pushpin: 가능한 만큼 const를 많이 사용하자

- 프로그램의 상태가 어떻게 어디서 변하는지를 아는 것은 중요하며, const를 사용하면 그러한 변화를 다루기에 편리한 코드를 만들 수 있다.
- 적절한 const 사용은 디자인에 대한 보다 나은 이해뿐만 아니라 코드의 안정성과 튼튼함에도 도움을 주기 때문이다.
- 특정 멤버 함수를 const로 만들 수 없다는 것을 알게 되는 것은 그만큼 그 멤버 함수가 객체의 상태를 변경할 수도 있다는 점을 알게 되는 것이며, 물리적인 불변성과 논리적인 불변성 사이에 놓여있는 데이터 멤버에 대해서도 이해할 수 있게 된다.

<br>

### :pushpin: const를 사용하면 안 되는 상황

1. 함수 선언부에 있는 값에 의한 전달 인자에는 const를 사용하지 말아야 한다.

   > ```c++
   > void func(int x);
   > void func(const int x); // 같은 함수를 다시 선언한 것으로, 최상위 const는 무시된다.
   > ```
   >
   > :point_right: 두 번째 선언에 있는 const는 불필요한 것이다.
   >
   > :point_right: 이러한 최상위 수준의 const는 함수 선언에 넣지 않는 것이 좋으며, 헤더 파일을 읽는 사람에게 혼란을 줄뿐이다.
   >
   > <br>
   >
   > ```c++
   > void func(const int x){
   >     // ...
   >     ++x; // 오류 발생(const값은 변경 불가)
   > }
   > ```
   >
   > :point_right: 하지만 함수의 정의 내에서는 이러한 최상위 const를 사용하는 것은 의미가 있다.
   >
   > :point_right: 인자값의 변경을 막고자 할 때 사용되기 때문이다.

